<% const title = 'Your Recommended Framework'; %>
<%- include('../layout-wrapper', { body: `
<link rel="stylesheet" href="/css/wizard.css">

<div class="wizard-container">
  <div class="wizard-recommendation">
    <!-- Success Animation -->
    <div class="recommendation-icon">
      <i class='bx bx-check-circle'></i>
    </div>

    <%
      // Adjust messaging based on confidence level
      let title, subtitle;
      if (recommendation.confidence >= 70) {
        title = 'Great Match Found!';
        subtitle = 'Based on your answers, we recommend:';
      } else if (recommendation.confidence >= 50) {
        title = 'We Have a Recommendation';
        subtitle = 'Based on your answers, this framework fits your needs:';
      } else {
        title = 'Here\'s Our Suggestion';
        subtitle = 'Based on your answers, we think this could work well:';
      }
    %>
    <h1 class="recommendation-title"><%= title %></h1>
    <p class="recommendation-subtitle"><%= subtitle %></p>

    <!-- Framework Card -->
    <div class="recommendation-framework-card">
      <h2 class="framework-name">${recommendation.frameworkName}</h2>
      <div class="confidence-badge">
        <i class='bx bx-trending-up'></i>
        ${recommendation.confidence}% match
      </div>
    </div>

    <!-- Explanation Section -->
    <div class="recommendation-explanation">
      <h3><i class='bx bx-bulb'></i> What This Framework Does</h3>
      <p class="explanation-text">${recommendation.explanation}</p>
    </div>

    <!-- Why Chosen Section -->
    <div class="recommendation-why">
      <h3><i class='bx bx-list-check'></i> Why We Chose This for You</h3>
      <ul class="why-chosen-list">
        ${recommendation.whyChosen.map(reason => `
          <li><i class='bx bx-check'></i> ${reason}</li>
        `).join('')}
      </ul>
    </div>

    <!-- Actions -->
    <div class="recommendation-actions">
      ${recommendation.prepopulateData ? `
        <a href="/frameworks/${recommendation.frameworkId}?fromWizard=true&prepopulate=${encodeURIComponent(JSON.stringify(recommendation.prepopulateData))}" class="btn btn-primary btn-large">
          <i class='bx bx-play-circle'></i>
          Start with ${recommendation.frameworkName}
        </a>
      ` : `
        <a href="/frameworks/${recommendation.frameworkId}?fromWizard=true" class="btn btn-primary btn-large">
          <i class='bx bx-play-circle'></i>
          Start with ${recommendation.frameworkName}
        </a>
      `}
      
      <div class="secondary-actions">
        <a href="/frameworks" class="btn-link">
          <i class='bx bx-grid-alt'></i>
          Browse all frameworks instead
        </a>
        <form action="/wizard/reset" method="POST" style="display: inline;">
          <button type="submit" class="btn-link">
            <i class='bx bx-refresh'></i>
            Try the wizard again
          </button>
        </form>
      </div>
    </div>

    <!-- Educational Tip -->
    ${recommendation.confidence < 50 ? `
    <div class="recommendation-tip" style="background: #fff3cd; border-color: #ffc107;">
      <i class='bx bx-info-circle' style="color: #856404;"></i>
      <p style="color: #856404;"><strong>Note:</strong> Your answers didn't strongly favor one framework. We've suggested the best match, but feel free to browse all frameworks to find what resonates with you.</p>
    </div>
    ` : `
    <div class="recommendation-tip">
      <i class='bx bx-info-circle'></i>
      <p><strong>Pro Tip:</strong> You can always switch to a different framework later if you want to try a different approach.</p>
    </div>
    `}
  </div>
</div>

<script src="/js/wizard.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Track recommendation view
  console.log('Wizard complete:', {
    framework: '${recommendation.frameworkId}',
    confidence: ${recommendation.confidence}
  });
  
  // Add confetti or celebration animation here if desired
});
</script>
`, user, subscription }) %>
