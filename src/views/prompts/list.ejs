<% const title = 'My Prompts'; %>
<%- include('../layout-wrapper', { body: `
<style>
  .prompts-header {
    margin-bottom: 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
  }
  
  .prompts-header h2 {
    margin: 0;
  }
  
  .prompts-header .btn {
    min-height: var(--touch-target-min);
  }
  
  .empty-state {
    text-align: center;
    padding: 2rem 1rem;
    background: var(--color-bg-light);
    border-radius: 8px;
  }
  
  .empty-state p {
    font-size: clamp(1rem, 3vw, 1.25rem);
    color: var(--color-text-light);
    margin-bottom: 1rem;
  }
  
  .empty-state .btn {
    min-height: var(--touch-target-min);
  }
  
  .prompt-row {
    padding: 1.5rem;
    background: var(--color-bg-light);
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  
  .prompt-content {
    flex: 1;
  }
  
  .prompt-content h3 {
    margin-bottom: 0.25rem;
  }
  
  .prompt-meta {
    color: var(--color-text-light);
    font-size: 0.875rem;
    margin-bottom: 0.5rem;
  }
  
  .prompt-preview {
    color: var(--color-text);
    white-space: pre-wrap;
    max-height: 100px;
    overflow: hidden;
  }
  
  .prompt-actions {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }
  
  .prompt-actions .btn {
    min-height: var(--touch-target-min);
    flex: 1;
    min-width: fit-content;
  }
  
  @media (min-width: 768px) {
    .prompt-row {
      flex-direction: row;
      align-items: start;
    }
    
    .prompt-actions {
      flex-wrap: nowrap;
      margin-left: 1rem;
    }
    
    .prompt-actions .btn {
      flex: 0 0 auto;
    }
    
    .empty-state {
      padding: 3rem;
    }
  }
</style>

<div class="prompts-header">
  <h2>My Prompts</h2>
  <a href="/frameworks" class="btn">Create New Prompt</a>
</div>

${!subscription.isPremium && prompts.length >= 5 ? `
  <div class="error">
    You've reached your free tier limit of 5 prompts. <a href="/premium">Upgrade to Premium</a> for unlimited prompts.
  </div>
` : ''}

${prompts.length === 0 ? `
  <div class="empty-state">
    <p>You haven't saved any prompts yet.</p>
    <a href="/frameworks" class="btn">Create Your First Prompt</a>
  </div>
` : `
  <div class="grid grid-cols-1 grid-gap-md">
    ${prompts.map(p => `
      <div id="prompt-row-${p.id}" class="prompt-row">
        <div class="prompt-content">
          <h3>${p.title}</h3>
          <p class="prompt-meta">
            ${p.frameworkType} â€¢ ${new Date(p.createdAt).toLocaleDateString()}
          </p>
          <p class="prompt-preview">${p.finalPromptText.substring(0, 200)}${p.finalPromptText.length > 200 ? '...' : ''}</p>
        </div>
        <div class="prompt-actions">
          <a href="/prompts/${p.id}" class="btn btn-secondary">View</a>
          ${subscription.isPremium ? `
            <a href="/prompts/${p.id}/export" class="btn">Export</a>
          ` : ''}
          <button 
            hx-delete="/prompts/${p.id}" 
            hx-target="#prompt-row-${p.id}" 
            hx-swap="outerHTML"
            hx-confirm="Are you sure you want to delete this prompt?"
            class="btn btn-danger">Delete</button>
        </div>
      </div>
    `).join('')}
  </div>
`}
`, user, subscription }) %>
